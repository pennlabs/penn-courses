deploy_version: 0.1.9
applications:
  - name: redis
    image: redis
    tag: "4.0"
  - name: celery
    image: pennlabs/penn-courses-backend
    secret: penn-courses
    cmd: ["celery", "worker", "-A", "PennCourses", "-Q", "alerts,celery", "-linfo"]
  - name: beat
    image: pennlabs/penn-courses-backend
    secret: penn-courses
    cmd: ["celery", "-A", "PennCourses", "beat", "-l", "info", "--scheduler", "django_celery_beat.schedulers:DatabaseScheduler"]
  - name: backend
    image: pennlabs/penn-courses-backend
    secret: penn-courses
    ingress:
      hosts:
        - host: penncourseplan.com
          paths: ["/api"]
  - name: plan
    image: pennlabs/pcp-frontend
    secret: penn-courses-plan
    ingress:
      hosts:
        - host: penncourseplan.com
          paths: ["/"]
  - name: alert
    image: pennlabs/penn-courses-backend
    secret: penn-courses
    ingress:
      hosts:
        - host: penncoursealert.com
          paths: ["/"]
          extraEnv:
            - key: ROOT_URLCONF
              value: PennCourses.urls.pca
